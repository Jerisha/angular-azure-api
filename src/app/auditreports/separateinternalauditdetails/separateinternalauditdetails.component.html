<mat-sidenav-container class="side-container">
  <mat-sidenav #pagesidenav class="side-nav" mode="side" opened>
    <form [formGroup]="thisForm" (ngSubmit)="onFormSubmit()" autocomplete="off">
      <div class="matsidenav-filter">
        <ng-container *ngIf="configDetails  as config">
          <mat-form-field [ngClass]="{'hidden':form.StartTelephoneNumber.disabled}" hintLabel="Max 11 characters">
            <mat-label>Start Telephone No</mat-label>
            <input id="StartTelephoneNumber" telNoPrefixValidator formControlName="StartTelephoneNumber" matInput
              #StartTelephoneNumber maxlength="11" placeholder="Start Telephone No" (blur)="getPnlControlAttributes()"
              (keypress)="numberOnly($event)" style="margin-right: 24%;">
            <mat-error>
              <div *ngIf="form.StartTelephoneNumber.touched && form.StartTelephoneNumber.invalid"
                class="alert alert-danger">
                <div *ngIf="form.StartTelephoneNumber.errors?.incorrect">Enter Start Telephone No </div>
                <div *ngIf="form.StartTelephoneNumber.errors?.invalidPrefix">Telephone No Prefix is not valid</div>
                <!-- <div *ngIf="form.StartTelephoneNumber.errors?.pattern">Telephone No should be 10 or 11 digit</div> -->
              </div>
            </mat-error>
            <mat-hint align="end">{{StartTelephoneNumber.value?.length || 0}}/11</mat-hint>
          </mat-form-field>
          <mat-form-field [ngClass]="{'hidden':form.EndTelephoneNumber.disabled}" hintLabel="Max 11 characters">
            <mat-label>End Telephone No</mat-label>
            <input id="EndTelephoneNumber" telNoPrefixValidator compareStartNo [startNo]="form.StartTelephoneNumber"
              formControlName="EndTelephoneNumber" matInput #EndTelephoneNumber maxlength="11"
              placeholder="End Telephone No" (blur)="getPnlControlAttributes('EndTelNo')"
              (keypress)="numberOnly($event)">
            <mat-error>
              <div *ngIf="form.EndTelephoneNumber.touched && form.EndTelephoneNumber.invalid"
                class="alert alert-danger">
                <div *ngIf="form.EndTelephoneNumber.errors?.invalidStartNo">Enter Start Telephone No </div>
                <div *ngIf="form.EndTelephoneNumber.errors?.lesserStartNo">Start Telephone No should be less than End
                  Telephone No</div>
                <div *ngIf="form.EndTelephoneNumber.errors?.invalidPrefix">Telephone No Prefix is not valid</div>
                <!-- <div *ngIf="form.EndTelephoneNumber.errors?.pattern">Telephone No should be 10 or 11 digit</div> -->
              </div>
            </mat-error>
            <mat-hint align="end">{{EndTelephoneNumber.value?.length || 0}}/11</mat-hint>
          </mat-form-field>
          <mat-form-field [ngClass]="{'hidden':form.AuditActID.disabled}">
            <mat-label>Audit ACT ID *</mat-label>
            <mat-select #auditACTId formControlName="AuditActID" [(ngModel)]="defaultACTID">
              <mat-option *ngFor="let val of config.SepInternalAuditActID" [value]="val">
                {{val}} </mat-option>
            </mat-select>
            <mat-error>
              <div *ngIf="form.AuditActID.hasError('required')" class="alert alert-danger">
                Select Audit ACT ID
              </div>
            </mat-error>
          </mat-form-field>
          <mat-form-field [ngClass]="{'hidden':form.OSN2Source.disabled}">
            <mat-label>OSN2 Source</mat-label>
            <mat-select formControlName="OSN2Source">  
              <mat-option>-- Select --</mat-option> 
              <mat-option *ngFor="let val of config.OSN2Source" [value]="val">
                {{val}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field [ngClass]="{'hidden':form.InternalCLIStatus.disabled}">
            <mat-label>Internal CLI Status</mat-label>
            <mat-select formControlName="InternalCLIStatus">  
              <mat-option>-- Select --</mat-option> 
              <mat-option *ngFor="let val of config.InternalCLIStatus" [value]="val">
                {{val}}
              </mat-option>
            </mat-select>
          </mat-form-field>
            <mat-form-field [ngClass]="{'hidden':form.ResolutionType.disabled}">
              <mat-label>Resolution Type</mat-label>
              <mat-select formControlName="ResolutionType">  
                <mat-option>-- Select --</mat-option> 
                <mat-option *ngFor="let val of config.ResolutionTypeAudit" [value]="val">
                  {{val}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          <mat-form-field [ngClass]="{'hidden':form.SourceStatus.disabled}">
            <mat-label>Source Status</mat-label>
            <mat-select formControlName="SourceStatus">  
              <mat-option>-- Select --</mat-option> 
              <mat-option *ngFor="let val of config.SourceStatus" [value]="val">
                {{val}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field [ngClass]="{'hidden':form.PostcodeDifference.disabled}">
            <mat-label>Post Code Difference</mat-label>
            <mat-select formControlName="PostcodeDifference">  
              <mat-option>-- Select --</mat-option> 
              <mat-option *ngFor="let val of config.PostcodeDifference" [value]="val">
                {{val}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field [ngClass]="{'hidden':form.FullAddressDifference.disabled}">
            <mat-label>Full Address Difference</mat-label>
            <mat-select formControlName="FullAddressDifference">  
              <mat-option>-- Select --</mat-option> 
              <mat-option *ngFor="let val of config.FullAddressDifference" [value]="val">
                {{val}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field [ngClass]="{'hidden':form.CustomerDifference.disabled}">
            <mat-label>Customer Difference</mat-label>
            <mat-select formControlName="CustomerDifference">  
              <mat-option>-- Select --</mat-option> 
              <mat-option *ngFor="let val of config.CustomerDifference" [value]="val">
                {{val}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </ng-container>
      </div>
      <div class="matsidenav-footer">
        <button type="submit" mat-raised-button color="primary">
          <mat-icon>search</mat-icon>Search
        </button>
        <button type="reset" mat-raised-button color="primary" (click)="resetForm()">
          <mat-icon>refresh</mat-icon>Reset
        </button>
      </div>
    </form>
  </mat-sidenav>
  <mat-sidenav-content class="side-content">
    <button *ngIf="tabs.length!=0" class="slidderbtn" mat-basic-button color="primary" (click)="pagesidenav.toggle()"
      matTooltip="{{pagesidenav.opened ? 'Hide Filters' : 'Show Filters'}}">
      <mat-icon>{{pagesidenav.opened ? 'keyboard_arrow_left' : 'keyboard_arrow_right'}}</mat-icon>
    </button>
    <app-start-up *ngIf="tabs.length===0"></app-start-up>
    <mat-tab-group [(selectedIndex)]="selectedTab">
      <mat-tab *ngFor="let tab of tabs; let index = index">
        <ng-template mat-tab-label>
          <div class="col" style="margin-left: 20px;">{{tab.name}}</div>
          <button *ngIf="tab.tabType !== 0" style="color:black" matSuffix mat-icon-button (click)="removeTab(index)">
            <mat-icon style="font-size: large;">close</mat-icon>
          </button>
        </ng-template>
        <span [ngSwitch]="tab.tabType">
          <div *ngSwitchCase="0" style="height: calc(100% - 30px);">
            <app-table-selection [sidePan]="pagesidenav" [tableitem]="myTable" (rowChanges)="rowDetect($event)"
              (addNewTab)="newTab($event)" (pageIndex)="getNextSetRecords($event)">
            </app-table-selection>
            <form [formGroup]="updateForm" (ngSubmit)="onSaveSubmit()" autocomplete="off" *ngIf="updateAccess">
              <ng-container *ngIf="updateDetails as con">
                <mat-form-field>
                  <mat-label>Resolution Type</mat-label>
                  <mat-select  name="Resolution" formControlName="Resolution" required [(ngModel)]="resolutionType">
                    <mat-option *ngFor="let val of con.ResolutionType" [value]="val">
                      {{val}}
                    </mat-option>
                  </mat-select>
                  <mat-error class="alert alert-danger">                          
                    <div *ngIf="updateFormControls.Resolution.errors?.required">
                      <!-- <div *ngIf="f.StartTelephoneNumber.errors?.required">Please enter Telephone No</div> -->
                      Select resolution type
                    </div>
                  </mat-error>
                </mat-form-field>
            </ng-container>
              <mat-form-field class="side-textarea" hintLabel="Max 500 characters">
                <mat-label>Remarks</mat-label>
                <textarea id="remarks" required name="remarks" [(ngModel)]="remarkstxt" formControlName="Remarks"
                  #inputctrl matInput maxlength="500" placeholder="Remarks"></textarea>
                <mat-hint align="end">{{inputctrl.value?.length || 0}}/500</mat-hint>
                <mat-error class="alert alert-danger">
                  <div *ngIf="updateFormControls.Remarks.hasError('incorrect')">
                    Add remarks for Manual Data Correction
                  </div>
                  <div *ngIf="updateFormControls.Remarks.hasError('required')">
                    Add remarks for resolution
                  </div>
                </mat-error>
              </mat-form-field>
              <button [disabled]="disableSave" type="submit" mat-raised-button color="primary">
                <mat-icon>save</mat-icon>Save
              </button>
              <button type="submit" mat-raised-button
              color="primary" [disabled]="disableAudit" (click)="DisplaySelectedFullAuditDetails()">
              FullAudit
            </button>
              <mat-form-field *ngIf="showDataCorrection">
                <mat-label>Data Corrections</mat-label>
                <mat-select disableOptionCentering panelClass="matselect-centering" name="correctionType"
                  (selectionChange)="getSelectedDataCorrection()" [(value)]="selectedCorrectionType"
                  placeholder="Data Corrections">
                  <mat-optgroup *ngFor="let group of correctionTypes" [label]="group.name"
                    [ngStyle]="{ display : group.disabled? 'none' : 'block' }">
                    <mat-option *ngFor="let correction of group.subOption"
                      [ngStyle]="{ display : correction.disabled? 'none' : 'block' }" [value]="correction.value">
                      {{correction.viewValue}}
                    </mat-option>
                  </mat-optgroup>
                </mat-select>
              </mat-form-field>
              &nbsp;
              <mat-form-field *ngIf="selectedCorrectionType=='AutoCorrectionVolume'" style="width: 85px !important;">
                <mat-label>Select</mat-label>
                <input name="range" required ngDefaultControl [(ngModel)]="rowRange"
                  [ngModelOptions]="{standalone: true}" type="text" #range="ngModel" matInput
                  [matAutocomplete]="autoRange" OptionsValidator [options]="configDetails.AutoCorrectionVolume  " />
                <span matSuffix mat-icon-button>
                  <mat-icon>arrow_drop_down</mat-icon>
                </span>
                <mat-autocomplete autoActiveFirstOption #autoRange="matAutocomplete">
                  <mat-option *ngFor="let val of configDetails.AutoCorrectionVolume   | ddlFilter: range.value"
                    [value]="val">
                    {{val}}
                  </mat-option>
                </mat-autocomplete>
                <mat-error class="alert alert-danger">
                  <div *ngIf="range.errors?.validOptions">Value need to match available
                    options</div>
                  <div *ngIf="range.errors?.required">
                    Select Auto correction volume
                  </div>
                </mat-error>
              </mat-form-field>&nbsp;
              <ng-container *ngIf="selectedCorrectionType!=''">
                <button [disabled]="disableProcess" type="button" (click)="processDataCorrection()" mat-raised-button
                  color="primary">
                  Process
                </button>
              </ng-container>
            </form>
          </div>
          <div *ngSwitchCase="1" style="height: calc(100% - 8px);">
            <app-telephone-audit-trail [telNo]="auditTelNo" [repIdentifier]="repIdentifier"></app-telephone-audit-trail>
          </div>
          <div *ngSwitchCase="2" style="height: calc(100% - 8px);">
            <app-full-audit [attributes]="fullauditattributes">
            </app-full-audit>
          </div>
          <div *ngSwitchCase="3" style="height: calc(100% - 8px);">
          </div>
          <div *ngSwitchDefault>
          </div>
        </span>
      </mat-tab>
    </mat-tab-group>
  </mat-sidenav-content>
</mat-sidenav-container>