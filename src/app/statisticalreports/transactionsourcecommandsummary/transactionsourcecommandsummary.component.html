<table mat-table [dataSource]="data" multiTemplateDataRows matSort style="width:50%;font-size: small!important;">
	<ng-container [matColumnDef]="column" *ngFor="let column of columnsToDisplay">
    <div *ngIf="column === 'Expand'">
      
      <th  mat-header-cell *matHeaderCellDef>{{column}}</th>
      <td  mat-cell *matCellDef="let row "
      [class.example-element-row]="row.addresses?.length" [class.example-expanded-row]="row?.expanded"
      (click)="row.expanded = !row?.expanded" 
      >
        <ng-container>

          <mat-icon style="cursor: pointer;" class="transaction-trend-table-icon"
            (click)="(expandedElement = expandedElement === row ? null : row); (expandedElement === row ? setAddressDetails('transaction', row) : null); setStep(2) ">
            {{row.expanded ? 'remove_box_outline' : 'add_box_outline'}}</mat-icon>

        </ng-container>
      </td>
    </div>
    <div *ngIf="column === 'Action'">
      <th mat-header-cell *matHeaderCellDef> {{column}} </th>
      <td mat-cell *matCellDef="let element"> 
        <mat-icon   mat-tooltip="Click this button, this row Record will be open in Edit Pane">
          mode_edit_outline</mat-icon>

      </td>
      </div>
    <div *ngIf="column != 'Expand'&&column != 'Action'">
		<th mat-header-cell *matHeaderCellDef> {{column}} </th>
		<td mat-cell *matCellDef="let element"> {{element[column]}} </td>
    </div>
	</ng-container>

	<ng-container matColumnDef="expandedDetail">
		<td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
			<div class="example-element-detail" [@detailExpand]="element?.expanded"  *ngIf="element?.expanded">
				<div style="width: 100%;">

					<table mat-table id="innertable" [dataSource]="element.addresses" multiTemplateDataRows matSort style="font-size:small!important">
						<ng-container matColumnDef="{{innerColumn}}" *ngFor="let innerColumn of innerDisplayedColumns">
						  <div *ngIf="innerColumn === 'Action'">
                <th mat-header-cell *matHeaderCellDef> {{innerColumn}} </th>
                <td mat-cell *matCellDef="let element"> 
                  <mat-icon   mat-tooltip="Click this button, this row Record will be open in Edit Pane">
                    mode_edit_outline</mat-icon>
          
                </td>
                </div>
                <div *ngIf="innerColumn === 'Expand'"  >
      
                  <th mat-header-cell *matHeaderCellDef>{{innerColumn}}</th>
                  <td mat-cell *matCellDef="let row " 
                  [class.example-element-row]="row.comments?.length" [class.example-expanded-row]="row?.expanded"
							(click)="row.expanded = !row?.expanded"
                  > 
                    <ng-container>
            
                      <mat-icon style="cursor: pointer;" class="transaction-trend-table-icon"
                        (click)="(expandedElement = expandedElement === row ? null : row); (expandedElement === row ? setAddressDetails('transaction', row) : null); setStep(2) ">
                        {{row.expanded ? 'remove_box_outline' : 'add_box_outline'}}</mat-icon>
            
                    </ng-container>
                  </td>
                </div>
                <div *ngIf="innerColumn != 'Action'&&innerColumn != 'Expand'">
              <th mat-header-cell *matHeaderCellDef > {{innerColumn}} </th>
							<td mat-cell *matCellDef="let address"  > {{address[innerColumn]}} </td>
                </div>
						</ng-container>

						<ng-container matColumnDef="expandedExpandedDetail">
							<td mat-cell *matCellDef="let address" [attr.colspan]="innerInnerDisplayedColumns.length">
								<div class="example-element-detail" [@detailExpand]="address?.expanded" *ngIf="address?.expanded">
									<div style="width: 100%;">

										<table style="width: 100%;" #inneTables mat-table #innrSort="matSort"
											[dataSource]="address?.comments" matSort style="font-size:small!important">
											<ng-container matColumnDef="{{col}}" *ngFor="let col of innerInnerDisplayedColumns">
                        <div *ngIf="col === 'Action'">
                          <th mat-header-cell *matHeaderCellDef> {{col}} </th>
                          <td mat-cell *matCellDef="let element"> 
                            <mat-icon   mat-tooltip="Click this button, this row Record will be open in Edit Pane">
                              mode_edit_outline</mat-icon>
                    
                          </td>
                          </div>
                          <div *ngIf="col != 'Action'">
                        <th mat-header-cell *matHeaderCellDef > {{col}} </th>
												<td mat-cell *matCellDef="let comment"> {{comment[col]}} </td>
                          </div>
											</ng-container>


											<tr mat-header-row *matHeaderRowDef="innerInnerDisplayedColumns"  style="visibility:collapse"></tr>
											<tr mat-row *matRowDef="let comment; columns: innerInnerDisplayedColumns;" class="innertab">
											</tr>
										</table>
									</div>
								</div>
							</td>
						</ng-container>

						<tr mat-header-row *matHeaderRowDef="innerDisplayedColumns" style="visibility:collapse"></tr>
						<tr mat-row *matRowDef="let address; columns: innerDisplayedColumns;"
							>
						</tr>
						<tr mat-row *matRowDef="let row; columns: ['expandedExpandedDetail']" class="example-detail-row">
						</tr>
					</table>
				</div>
			</div>
		</td>
	</ng-container>

	<tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr> 
	<tr mat-row *matRowDef="let element; columns: columnsToDisplay;"
	>
	</tr>
	<tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
</table>

