<div #auditTabScroll class="audit-trail-container" id="auditTab">
    <ng-template #NoData>
        <div class="no-record-found-centre" *ngIf="!isLoading">
            <span>No records found for this Telephone Number</span>
        </div>
    
    </ng-template>
        <ng-container *ngIf="auditTrailReport$ | async  as AT;else NoData">
            {{AT.LiveDetails ? testfun(false) :testfun(true) }}
            <div  class = "live-records" *ngIf="AT.LiveDetails; else elseBlock">            
                <mat-accordion *ngIf="AT.LiveDetails[0] as livedata; else elseBlock" [togglePosition]="'before'">
                    <!-- <div class="accordionWidth"> -->
                        <div class="audit-trail-accordion-width">
                    <mat-expansion-panel [hideToggle]="'true'" [expanded]="step === 0"
                        (opened)="setStep(0); panelOpenState1 = true;  setAddressDetails('TransactionDetails', livedata);"
                        (closed)="panelOpenState1 = false; setAddressDetails('RemoveAddress');">
    
                        <mat-expansion-panel-header class ="audit-trail-mat-expansion-panel-header">
                            <mat-panel-title class ="audit-trail-mat-panel-title">
                                <!-- <mat-icon class="table-icon">{{panelOpenState1 && step === 0 ? 'remove_box_outline' :
                                    'add_box_outline'}}</mat-icon> -->
                                    <mat-icon class="audit-trail-table-icon">{{panelOpenState1 && step === 0 ? 'remove_box_outline' :
                                        'add_box_outline'}}</mat-icon>
                                &nbsp;&nbsp;
                                Current Live Details
                            </mat-panel-title>
                        </mat-expansion-panel-header>
    
                        <div class="audit-trail-liverecord-sec audit-trail-border">
                            <div class="container-fluid">
                                <div class="fluid-item liverecord-sec-1">
    
                                    <div>
                                        <span class="audit-trail-label"> Transaction ID</span>
                                        <span class="audit-trail-text-display">{{livedata.TransactionId}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Parent CUPID</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.ParentCupid}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Child CUPID</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.ChildCupid}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Customer Title</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.CustomerTitle}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Customer Forename</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.CustomerForename}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Customer Name</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.CustomerName}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Business Suffix</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.BusinessSuffix}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Premises</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.Premises}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Thoroughfare</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.Thoroughfare}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Locality</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.Locality}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Postcode</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.Postcode}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Retailer ID</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.RetailerId}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Address ID</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.AddressId}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Address ID Source</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.AddressIdSource}}</span>
                                    </div>
    
                                </div>
    
                                <div class="fluid-item liverecord-sec-2">
    
                                    <div>
                                        <span class="audit-trail-label">Transaction Reference</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.TransactionReference}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Created On</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.CreatedOn}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Created By</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.CreatedBy}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Source System</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.Source}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Franchise</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.Franchise}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Source Type</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.SourceType}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Internal Address1</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.InternalAddress1}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Internal Address2</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.InternalAddress2}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Internal Address3</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.InternalAddress3}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Internal Address4</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.InternalAddress4}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">New Telephone No.</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.NewTelephoneNumber}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">XReference</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.XReference}}</span>
                                    </div>
    
                                    <div>
                                        <span class="audit-trail-label">Line Type</span>
                                        <span class="audit-trail-text-display">
                                            {{livedata.LineType}}</span>
                                    </div>
    
                                </div>
    
                            </div>
                        </div>
    
                    </mat-expansion-panel>
                    </div>
                </mat-accordion>
            </div>
    
            <ng-template #elseBlock>
                <!-- <div class="liveRecord-error error"> -->
                    <div class ="no-record-found-centre">              
                    <span>No Current Live Records Found</span>
                </div>
                </ng-template>
    
        <mat-accordion *ngIf=" AT.UnsolicitedDetails != null" [togglePosition]="'before'">
            <!-- <div class="accordionWidth"> -->
                <div class = "audit-trail-accordion-width">
            <mat-expansion-panel [hideToggle]="'true'" [expanded]="step === 1" (opened)="setStep(1); panelOpenState2 = true;"
                (closed)="panelOpenState2 = false">
                <mat-expansion-panel-header class ="audit-trail-mat-expansion-panel-header">
                    <mat-panel-title class ="audit-trail-mat-panel-title">
                        <mat-icon class="audit-trail-table-icon">{{panelOpenState2 && step === 1 ? 'remove_box_outline' :
                            'add_box_outline'}}</mat-icon>
                        &nbsp;&nbsp;
                        All Unsolicited Details
                    </mat-panel-title>
                </mat-expansion-panel-header>
    
                <!-- <div class="unsolicitedDetails-sec" > -->
                    <div>
                    <!-- <app-table class="appTable" [tableitem]="AT.UnsolicitedDetails"></app-table> -->
                    <app-table [tableitem]="AT.UnsolicitedDetails"></app-table>
                </div>
            <!-- </ng-template> -->
            </mat-expansion-panel>
            </div>
            </mat-accordion>
    
            <!-- <mat-accordion
                *ngIf="((repIdentifier === 'UnsolicitedErrors') && AT.UnsolicitedDetails != null); else elseBlock1;"
                [togglePosition]="'before'">
                <mat-expansion-panel [hideToggle]="'true'" [expanded]="step === 1"
                    (opened)="setStep(1); panelOpenState2 = true;" (closed)="panelOpenState2 = false">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            <mat-icon class="table-icon">{{panelOpenState2 && step === 1 ? 'remove_box_outline' :
                                'add_box_outline'}}</mat-icon>
                            &nbsp;&nbsp;
                            All Unsolicited Details
                        </mat-panel-title>
                    </mat-expansion-panel-header>
    
                    <div class="unsolicitedDetails-sec">
                        <app-table class="appTable" [tableitem]="AT.UnsolicitedDetails"></app-table>
                    </div>
    
                </mat-expansion-panel>
            </mat-accordion> -->
    
    
            <table mat-table [dataSource]="AT.AuditDetailedReport ? AT.AuditDetailedReport : []" multiTemplateDataRows
                class="mat-elevation-z8 audit-trail-table">
                <ng-container *ngFor="let col of columnsToDisplay ;" matColumnDef="{{col.headerValue}}">
                    <ng-container *ngIf="col.headerValue != 'Action'">
                        <th mat-header-cell *matHeaderCellDef class="audit-trail-table-header">{{col.header}}</th>
                        <td mat-cell *matCellDef="let element;"
                            [ngClass]="{ 'audit-trail-highlighted': AT.LiveDetails ? element.TransactionId === AT.LiveDetails[0].TransactionId : false}">
                            {{element.SummaryReport[0][col.headerValue]}}</td>
                    </ng-container>
                    <ng-container *ngIf="col.headerValue === 'Action'">
    
                        <th mat-header-cell *matHeaderCellDef class="audit-trail-table-header">{{col.header}}</th>
                        <td mat-cell
                            [ngClass]="{ 'audit-trail-highlighted': AT.LiveDetails ? element.TransactionId === AT.LiveDetails[0].TransactionId : false}"
                            *matCellDef="let element; let i = dataIndex;">
                            <mat-icon class="audit-trail-table-icon"
                                (click)="(expandedElement = expandedElement === element.DetailedReport ? null : element.DetailedReport);
                             setStep(2); (expandedElement === element.DetailedReport ? setAddressDetails('TransactionDetails', element.DetailedReport[0])
                              : setAddressDetails('RemoveAddress')); (AT.UnsolicitedDetails != null ? customScroll(i, true) : customScroll(i));">
                            {{expandedElement === element.DetailedReport && step === 2 ? 'remove_box_outline' :
                            'add_box_outline'}}
                        </mat-icon>
                    </td>
                </ng-container>
            </ng-container>
    
                <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
                <ng-container matColumnDef="expandedDetail" *ngIf="step === 2">
                    <td mat-cell *matCellDef="let element " [attr.colspan]="columnsToDisplay.length">
                        <!-- <div class="example-element-detail" -->
                        <div class="over-flow-hidden"
                            [@detailExpand]="(element.DetailedReport == expandedElement && step === 2 ? 'expanded' : 'collapsed')">
                            <div class="example-element-diagram audit-trail-border">
    
                                <div class="maindiv">
                                    <div class="details-sec" *ngIf="element.DetailedReport">
    
                                        <div class="container-fluid">
                                            <div class="fluid-item details-sec-1">
                                                <div>
                                                    <span class="audit-trail-label"> Transaction ID</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.TransactionId}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Transaction Command</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].TransactionCommand}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">BT Command</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].BtCommand}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Parent CUPID</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].ParentCupid}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Child CUPID</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].ChildCupid}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Change CUPID</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].ChangeCupid}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Customer Title</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].CustomerTitle}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Customer Forename</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].CustomerForename}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Customer Name</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].CustomerName}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Business Suffix</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].BusinessSuffix}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Premises</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Premises}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Thoroughfare</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Thoroughfare}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Locality</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Locality}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Postcode</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Postcode}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Retailer ID</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].RetailerId}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Address ID</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].AddressId}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Address ID Source</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].AddressIdSource}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">SAR Reference No.</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].SarReferenceNumber}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">SAR Transaction No.</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].SarTransactionNumber}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Reference</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Reference}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Connection Type</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].ConnectionType}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Access Method</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].AccessMethod}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Previous Transaction ID</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].PreviousTransactionId}}</span>
                                                </div>
    
                                            </div>
    
                                            <div class="fluid-item details-sec-2">
    
                                                <div>
                                                    <span class="audit-trail-label">Transaction Reference</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].TransactionReference}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Status</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Status}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">BT Source</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].BtSource}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Source System</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Source}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Franchise</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Franchise}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Order Reference</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].OrderReference}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Created On</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].CreatedOn}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Created By</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].CreatedBy}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Source Type</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].SourceType}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Internal Address1</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].InternalAddress1}}</span>
                                                </div>
                                                <div>
                                                    <span class="audit-trail-label">Internal Address2</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].InternalAddress2}}</span>
                                                </div>
                                                <div>
                                                    <span class="audit-trail-label">Internal Address3</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].InternalAddress3}}</span>
                                                </div>
                                                <div>
                                                    <span class="audit-trail-label">Internal Address4</span>
                                                    <span class="audit-trail-text-display">
    
                                                        {{element.DetailedReport[0].InternalAddress4}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Force validate</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].ForceValidate}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">New Telephone No.</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].NewTelephoneNumber}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">XReference</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].XReference}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Line Type</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].LineType}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Provide</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Provide}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Effective</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Effective}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">End Status</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].EndStatus}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Callback</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].Callback}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Type of Line</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].TypeOfLine}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Next Transaction ID</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.DetailedReport[0].NextTransactionId}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Comment</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.Comment}}</span>
                                                </div>
    
                                            </div>
    
                                        </div> <!-- container-fluid -->
    
                                    </div> <!-- details-sec -->
    
                                    <mat-divider class="audit-trail-mat-divider"></mat-divider>
    
                                    <!-- <div class="notification-sec">
                                        <div class="page-header"> -->
                                            <div class="audit-trail-notification">
                                                <div class="audit-trail-page-header">
                                            <span>Notification Data</span>
                                        </div>
    
                                        <!-- <div class="error" *ngIf="!element.NotificationData">No Records Found.</div> -->
                                        <div class ="no-record-found-left" *ngIf="!element.NotificationData">No Records Found.</div>
    
                                        <div class="container-fluid" *ngIf="element.NotificationData">
                                            <div class="fluid-item notification-sec-1">
                                                <div>
                                                    <span class="audit-trail-label">Start Telephone No.</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].StartTelephoneNumber}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Source System</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].Source}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Notification Status</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].NotificationStatus}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Notification Error</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].NotificationError}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Extracted Date</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].ExtractedDate}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Updated Date</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].UpdatedDate}}</span>
                                                </div>
    
                                            </div>
    
                                            <div class="fluid-item notification-sec-2">
    
                                                <div>
                                                    <span class="audit-trail-label">End Telephone No.</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].EndTelephoneNumber}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Order Reference </span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].OrderReference}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">Created On</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].CreatedOn}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">BT Status</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].BtStatus}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">BT Error Code</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].BtErrorCode}}</span>
                                                </div>
    
                                                <div>
                                                    <span class="audit-trail-label">BT Error Message</span>
                                                    <span class="audit-trail-text-display">
                                                        {{element.NotificationData[0].BtErrorMessage}}</span>
                                                </div>
    
                                            </div>
    
                                        </div> <!-- container-fluid -->
                                    </div> <!-- notification-sec-->
    
                                    <mat-divider class="audit-trail-mat-divider"></mat-divider>
    
    
                                    <div class="error-response-sec">
                                        <!-- <div class="page-header">Error Data</div> -->
                                        <div class="audit-trail-page-header">Error Data</div>
    
                                        <!-- <div class="error" *ngIf="!element.VodafoneError">No Records Found.</div> -->
                                        <div class ="no-record-found-left" *ngIf="!element.VodafoneError">No Records Found.</div>
                                        <!-- <app-table class="appTable" [tableitem]="element.VodafoneError"></app-table> -->
                                        <app-table  [tableitem]="element.VodafoneError"></app-table>
                                    </div>
    
                                    <mat-divider class="audit-trail-mat-divider"></mat-divider>
    
                                    <div class="response-sec">
                                        <!-- <div class="page-header">Response Data</div> -->
                                        <div class="audit-trail-page-header">Response Data</div>
                                        <!-- <h4>Response Data</h4> -->
                                        <!-- <div class="error" *ngIf="!element.SupplierError">No Records Found.</div> -->
                                        <div class ="no-record-found-left" *ngIf="!element.SupplierError">No Records Found.</div>
                                        <!-- <app-table class="appTable" [tableitem]="element.SupplierError"></app-table> -->
                                        <app-table [tableitem]="element.SupplierError"></app-table>
                                    </div>
                                    <mat-divider class="audit-trail-mat-divider"></mat-divider>
                                    <div class="resolution-sec">
                                        <!-- <div class="page-header">Resolution Data</div> -->
                                        <div class="audit-trail-page-header">Resolution Data</div>
                                        <!-- <h4>Resolution Data</h4> -->
                                        <!-- <div class="error" *ngIf="!element.ResolutionHistory">No Records Found.</div>
                                        <app-table class="appTable" [tableitem]="element.ResolutionHistory"></app-table> -->
                                        <div class ="no-record-found-left" *ngIf="!element.ResolutionHistory">No Records Found.</div>
                                        <app-table  [tableitem]="element.ResolutionHistory"></app-table>
                                    </div>
                                    <mat-divider class="audit-trail-mat-divider"></mat-divider>
    
                                </div> <!-- maindiv -->
                            </div>
                        </div>
                    </td>
                </ng-container>
    
               
    
                <tr mat-header-row *matHeaderRowDef="dataColumns;" class="audit-trail-mat-header-row"></tr>
                <tr mat-row *matRowDef="let element; columns: dataColumns; let i = index;" class="audit-trail-example-element-row"
                    [class.example-expanded-row]="expandedElement === element"></tr>
                <tr mat-row *matRowDef="let row; columns: ['expandedDetail']; let i = index;" class="audit-trail-example-detail-row">
                </tr>
            </table>
    
            <!-- Audit Trail Panel -->
            <div class="audit-sec">
                <mat-accordion [togglePosition]="'before'">
                    <!-- <div class="accordionWidth"> -->
                        <div class ="audit-trail-accordion-width">
                    <mat-expansion-panel [hideToggle]="'true'" [expanded]="step === 3"
                        (opened)="setStep(3); panelOpenState = true" (closed)="panelOpenState = false">
                        <mat-expansion-panel-header class ="audit-trail-mat-expansion-panel-header">
                            <mat-panel-title class ="audit-trail-mat-panel-title">
                                <mat-icon class="audit-trail-table-icon">{{panelOpenState && step === 3 ? 'remove_box_outline' :
                                    'add_box_outline'}}</mat-icon>
                                &nbsp;&nbsp;
                                Audit Trail Details for : {{AT.TelephoneNumber}}
                            </mat-panel-title>
                        </mat-expansion-panel-header>
    
                        <!-- <div class="page-header" [ngClass]="{'error' : !(AT.SeperateInternalAudit != null) }">
                        <ng-container [ngTemplateOutlet]="noRecordsMessage"
                            [ngTemplateOutletContext]="{ $implicit : AT.SeperateInternalAudit != null ? 'Separate Internal Audit Trail' : 'No Records for Separate Internal Audit Trail'}">
                        </ng-container>
                    </div> -->
    
                        <div class="page-header" *ngIf="AT.SeperateInternalAudit != null">Separate Internal Audit Trail
                        </div>
    
                        <ng-template #noRecordsMessage let-data>
                            {{data}}
                        </ng-template>
    
                        <div class="internalAudit-sec" *ngIf="AT.SeperateInternalAudit != null">
                            <ng-container *ngIf="AT.SeperateInternalAudit != null">
                                <table mat-table [dataSource]="AT.SeperateInternalAudit " multiTemplateDataRows
                                    class="mat-elevation-z8 audit-trail-table">
                                    <ng-container *ngFor="let col of internalAuditTrailHeader ; let colIndex = index"
                                        matColumnDef="{{col.headerValue}}">
                                        <ng-container *ngIf="col.header != 'User Comment'">
                                            <th mat-header-cell *matHeaderCellDef class="audit-trail-table-header">{{col.header}}</th>
                                            <td mat-cell *matCellDef="let element">{{element[col.headerValue]}}</td>
                                        </ng-container>
                                        <ng-container *ngIf="col.header === 'User Comment'">
    
                                            <th mat-header-cell *matHeaderCellDef class="audit-trail-table-header">{{col.header}}</th>
                                            <td mat-cell *matCellDef="let element">
                                                <mat-icon class="audit-trail-table-icon"
                                                    (click)="(expandedElement = expandedElement === element ? null : element);">
                                                    {{expandedElement === element ? 'remove_box_outline' :
                                                    'add_box_outline'}}
                                                </mat-icon>
                                            </td>
                                        </ng-container>
                                    </ng-container>
    
                                    <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns  -->
                                    <ng-container matColumnDef="expandedDetail">
                                        <td mat-cell *matCellDef="let element"
                                            [attr.colspan]="auditTrailInternalDisplay.length">
                                            <!-- <div class="example-element-detail" -->
                                            <div class="over-flow-hidden"
                                                [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
    
                                                <div class="no-record-found-left" *ngIf="!element.UserComment">No Records Found.
                                                </div>
    
                                                <app-table class="appTable" [tableitem]="element.UserComment">
                                                </app-table>
                                                <br>
                                            </div>
                                        </td>
                                    </ng-container>
    
                                    <tr mat-header-row *matHeaderRowDef="auditTrailInternalDisplay" class="audit-trail-mat-header-row"></tr>
                                    <tr mat-row *matRowDef="let element; columns: auditTrailInternalDisplay;"
                                        class="audit-trail-example-element-row audit-trail-mat-row"
                                        [class.example-expanded-row]="expandedElement === element">
                                    </tr>
                                    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']"
                                        class="audit-trail-example-detail-row">
                                    </tr>
                                </table>
                            </ng-container>
                        </div>
                        <mat-divider class="audit-trail-mat-divider" *ngIf="AT.SeperateInternalAudit != null"></mat-divider>
    
                        <div class="page-header" [ngClass]="{'no-record-found-left' : !(AT.FullAudit != null) }">
                            <ng-container [ngTemplateOutlet]="noRecordsMessage"
                                [ngTemplateOutletContext]="{ $implicit : AT.FullAudit != null ? 'Full Audit Trail' : 'No Records for Full Audit Trail'}">
                            </ng-container>
                        </div>
    
                        <div class="fullAudit-sec" *ngIf="AT.FullAudit != null">
                            <ng-container>
                                <table mat-table [dataSource]="AT.FullAudit" multiTemplateDataRows class="mat-elevation-z8 audit-trail-table">
                                    <ng-container *ngFor="let col of fullAuditTrailHeader ; let colIndex = index"
                                        matColumnDef="{{col.headerValue }}">
                                        <ng-container *ngIf="col.header != 'User Comment'">
                                            <th mat-header-cell *matHeaderCellDef class="audit-trail-table-header">{{col.header}}</th>
                                            <td mat-cell *matCellDef="let element">{{element[col.headerValue]}}</td>
                                        </ng-container>
                                        <ng-container *ngIf="col.header === 'User Comment'">
    
                                            <th mat-header-cell *matHeaderCellDef class="audit-trail-table-header">{{col.header}}</th>
                                            <td mat-cell *matCellDef="let element">
                                                <mat-icon class="audit-trail-table-icon"
                                                    (click)="(expandedElement = expandedElement === element ? null : element);">
                                                    {{expandedElement === element ? 'remove_box_outline' :
                                                    'add_box_outline'}}
                                                </mat-icon>
                                            </td>
                                        </ng-container>
                                    </ng-container>
    
                                    <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns  -->
                                    <ng-container matColumnDef="expandedDetail">
                                        <td mat-cell *matCellDef="let element"
                                            [attr.colspan]="fullAuditTrailDisplay.length">
                                            <!-- <div class="example-element-detail" -->
                                            <div class="over-flow-hidden"
                                                [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
    
                                                <div class ="no-record-found-left" *ngIf="!element.UserComment">No Records Found.</div>
                                                <!-- <div class="error" *ngIf="!element.UserComment">No Records Found.</div> -->
    
                                                <!-- <app-table class="appTable" [tableitem]="element.UserComment"> -->
                                                    <app-table [tableitem]="element.UserComment">
                                                </app-table>
                                                <br>
                                            </div>
                                        </td>
                                    </ng-container>
    
                                    <tr mat-header-row *matHeaderRowDef="fullAuditTrailDisplay" class="audit-trail-mat-header-row"></tr>
                                    <tr mat-row *matRowDef="let element; columns: fullAuditTrailDisplay;"
                                        class="audit-trail-example-element-row audit-trail-mat-row"
                                        [class.example-expanded-row]="expandedElement === element">
                                    </tr>
                                    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']"
                                        class="audit-trail-example-detail-row">
                                    </tr>
                                </table>
                            </ng-container>
                        </div>
                        <mat-divider class="audit-trail-mat-divider"></mat-divider>
                    </mat-expansion-panel>
                    </div>
                </mat-accordion>
            </div> <!-- audit-sec-->
    
        </ng-container>
    </div>
    