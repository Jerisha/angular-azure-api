<mat-sidenav-container class="side-container">
  <mat-sidenav #pagesidenav class="side-nav" mode="side" opened>
    <div class="filter-sticky">
      <app-select-multiple #selMultiple [listItems]="filterItems" [icon]="'filter_alt'"
        (changes)="setControlAttribute($event)">
      </app-select-multiple>
    </div>
    <form [formGroup]="thisForm" (ngSubmit)="onFormSubmit()" autocomplete="off">
      <div class="matsidenav-filter">
        <ng-container *ngIf="configResult$ | async  as config">
          <div [ngStyle]="{'display':thisForm.controls.StartTelephoneNumber.disabled ? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[0].default"  #StartTelephoneNumberOperator [resetvalue]="resetExp"
            (click) ="OnOperatorClicked(['StartTelephoneNumberOperator',StartTelephoneNumberOperator.selectedViewValue])"></app-select-exp>         
            <mat-form-field hintLabel="Max 11 characters"
                [ngClass]="{'hidden':f.StartTelephoneNumber.disabled}">
                <mat-label>Telephone No</mat-label>
                <input formControlName="StartTelephoneNumber" numbersOnly
                matInput maxlength="11" placeholder="Telephone No"  #telno  telNoPrefixValidator>
                <mat-hint align="end">{{telno.value?.length || 0}}/11</mat-hint>
                <mat-error>
                    <div *ngIf="f.StartTelephoneNumber.touched && f.StartTelephoneNumber.invalid"
                        class="alert alert-danger">
                        
                         <div *ngIf="f.StartTelephoneNumber.errors?.invalidPrefix">Telephone No Prefix is not valid</div>
                        <div *ngIf="f.StartTelephoneNumber.errors?.pattern">Telephone No should be 10 or 11 digit</div>
                    </div>
                </mat-error>
            </mat-form-field>
            </div>
          
          <div [ngStyle]="{'display':thisForm.controls.CustomerName.disabled ? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[1].default"  [resetvalue]="resetExp" #CustomerNameOperator
              (click)="OnOperatorClicked(['CustomerNameOperator',CustomerNameOperator.selectedViewValue])">
            </app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.CustomerName.disabled}">
              <mat-label>Customer Name</mat-label>
              <input formControlName="CustomerName" matInput #CustomerName maxlength="500" placeholder="Customer Name">
            </mat-form-field>
          </div>

          <div [ngStyle]="{'display':thisForm.controls.CreationDate.disabled ? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[2].default" [resetvalue]="resetExp"  #CreationDateOperator
              (click)="OnOperatorClicked(['CreationDateOperator',CreationDateOperator.selectedViewValue])">
            </app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.CreationDate.disabled}">
              <mat-label>Creation Date</mat-label>
              <input readonly formControlName="CreationDate" matInput #CreationDate placeholder="Creation Date"
                [matDatepicker]="picker">
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </div>

          <div [ngStyle]="{'display':thisForm.controls.PostCode.disabled ? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[1].default" [resetvalue]="resetExp"  #PostCodeOperator
              (click)="OnOperatorClicked(['PostCodeOperator',PostCodeOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.PostCode.disabled}">
              <mat-label>Postcode</mat-label>
              <input formControlName="PostCode" matInput #PostCode maxlength="20" placeholder="PostCode">
            </mat-form-field>
          </div>

          <div [ngStyle]="{'display':thisForm.controls.Premises.disabled ? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[1].default" [resetvalue]="resetExp" #PremisesOperator
              (click)="OnOperatorClicked(['PremisesOperator',PremisesOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.Premises.disabled}">
              <mat-label>Premises</mat-label>
              <input formControlName="Premises" matInput #AddressPremises maxlength="100" placeholder="Premises">
            </mat-form-field>
          </div>

          <div [ngStyle]="{'display':thisForm.controls.Thoroughfare.disabled ? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[1].default" [resetvalue]="resetExp"  #ThoroughfareOperator
              (click)="OnOperatorClicked(['ThoroughfareOperator',ThoroughfareOperator.selectedViewValue])">
            </app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.Thoroughfare.disabled}">
              <mat-label>Thoroughfare</mat-label>
              <input formControlName="Thoroughfare" matInput #Thoroughfare maxlength="100" placeholder="Thoroughfare">
            </mat-form-field>
          </div>

          <div [ngStyle]="{'display':thisForm.controls.Locality.disabled ? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[1].default" [resetvalue]="resetExp"  #LocalityOperator
              (click)="OnOperatorClicked(['LocalityOperator',LocalityOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.Locality.disabled}">
              <mat-label>Locality</mat-label>
              <input formControlName="Locality" matInput #Locality maxlength="100" placeholder="Locality">
            </mat-form-field>
          </div>

          <div [ngStyle]="{'display':thisForm.controls.Cupid.disabled ? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[0].default" [resetvalue]="resetExp" #CupidOperator
              (click)="OnOperatorClicked(['CupidOperator',CupidOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.Cupid.disabled}">
              <mat-label>Cupid</mat-label>
              <input formControlName="Cupid" (keypress)="numberOnly($event)"
               matInput #Cupid maxlength="100" placeholder="Cupid">
            </mat-form-field>
          </div>

          <!-- <div [ngStyle]="{'display':thisForm.controls.Source.disabled? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[3].default" [resetvalue]="resetExp" #SourceOperator
              (click)="OnOperatorClicked(['SourceOperator',SourceOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.Source.disabled}">
              <mat-label>Source System</mat-label>
              <input #source formControlName="Source" type="text" placeholder="Search Source" matInput
              [matAutocomplete]="autoSource" OptionsValidator [options]="config.Source "/>
                <span matSuffix mat-icon-button>
                <mat-icon>arrow_drop_down</mat-icon>
              </span>
              <mat-autocomplete autoActiveFirstOption #autoSource="matAutocomplete">
                  <mat-option *ngFor="let val of config.Source  | ddlFilter: source.value" [value]="val">
                    {{val}}</mat-option>
                </mat-autocomplete>
              
              <mat-error *ngIf="f.Source.errors?.validOptions">Value need to match available options</mat-error>

            </mat-form-field>
          </div> -->

          <div [ngStyle]="{'display':thisForm.controls.Source.disabled? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[3].default" [resetvalue]="resetExp" #SourceOperator
              (click)="OnOperatorClicked(['SourceOperator',SourceOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.Source.disabled}">
              <mat-label>Source System</mat-label>
                            <mat-select formControlName="Source">  
                              <!-- <mat-option>None</mat-option>           -->
                              <mat-option *ngFor="let val of config.Source" [value]="val">
                                {{val}}
                              </mat-option>
                            </mat-select>
            </mat-form-field>
          </div>

          <!-- <div [ngStyle]="{'display':thisForm.controls.Franchise.disabled? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[3].default"  [resetvalue]="resetExp" #FranchiseOperator
              (click)="OnOperatorClicked(['FranchiseOperator',FranchiseOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.Franchise.disabled}">
              <mat-label>Franchise</mat-label>
              <input #franchise formControlName="Franchise" type="text"  maxlength="100" placeholder="Search Franchise" matInput
                [matAutocomplete]="autoFranchise" OptionsValidator [options]="config.Franchise " />
              <span matSuffix mat-icon-button>
                <mat-icon>arrow_drop_down</mat-icon>
              </span>
              <mat-autocomplete autoActiveFirstOption #autoFranchise="matAutocomplete">
                <mat-option *ngFor="let val of config.Franchise | ddlFilter: franchise.value"
                  [value]="val">
                  {{val}}
                </mat-option>
              </mat-autocomplete>
              <mat-error *ngIf="f.Franchise.errors?.validOptions">Value need to match available options</mat-error>

            </mat-form-field>
          </div> -->

          <div [ngStyle]="{'display':thisForm.controls.Franchise.disabled? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[3].default"  [resetvalue]="resetExp" #FranchiseOperator
              (click)="OnOperatorClicked(['FranchiseOperator',FranchiseOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.Franchise.disabled}">
              <mat-label>Franchise</mat-label>
              <mat-select formControlName="Franchise">  
                <!-- <mat-option>None</mat-option>           -->
                <mat-option *ngFor="let val of config.Franchise" [value]="val">
                  {{val}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        
          <!-- <div [ngStyle]="{'display':thisForm.controls.TransactionCommand.disabled? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[3].default" [resetvalue]="resetExp" #TransactionCommandOperator
              (click)="OnOperatorClicked(['TransactionCommandOperator',TransactionCommandOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.TransactionCommand.disabled}">
              <mat-label>TransactionCommand</mat-label>
              <input #transactionCommand formControlName="TransactionCommand" type="text" placeholder="Search TransactionCommand" matInput
                [matAutocomplete]="autoTransactionCommand"  maxlength="100" OptionsValidator [options]="config.TransactionCommand " />
              <span matSuffix mat-icon-button>
                <mat-icon>arrow_drop_down</mat-icon>
              </span>
              <mat-autocomplete autoActiveFirstOption #autoTransactionCommand="matAutocomplete">
                <mat-option *ngFor="let option of config.TransactionCommand | ddlFilter: transactionCommand.value"
                  [value]="option">
                  {{option}}
                </mat-option>

              </mat-autocomplete>
              <mat-error *ngIf="f.TransactionCommand.errors?.validOptions">Value need to match available options</mat-error>

            </mat-form-field>
          </div> -->

          <div [ngStyle]="{'display':thisForm.controls.TransactionCommand.disabled? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[3].default" [resetvalue]="resetExp" #TransactionCommandOperator
              (click)="OnOperatorClicked(['TransactionCommandOperator',TransactionCommandOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.TransactionCommand.disabled}">
              <mat-label>Transaction Command</mat-label>
              <mat-select formControlName="TransactionCommand">  
                <!-- <mat-option>None</mat-option>           -->
                <mat-option *ngFor="let val of config.TransactionCommand" [value]="val">
                  {{val}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div [ngStyle]="{'display':thisForm.controls.TypeOfLine.disabled ? 'none' : 'block'}">
            <app-select-exp [listItems]="expressions[3].default" [resetvalue]="resetExp"#TypeOfLineOperator
              (click)="OnOperatorClicked(['TypeOfLineOperator',TypeOfLineOperator.selectedViewValue])"></app-select-exp>
            <mat-form-field appearance="outline" [ngClass]="{'hidden':thisForm.controls.TypeOfLine.disabled}">
              <mat-label>Type Of Line</mat-label>
              <input #typeOfLine formControlName="TypeOfLine" [(ngModel)]="model.TypeOfLine" type="text" placeholder="Search Type of Line" matInput
                [matAutocomplete]="autoTypeOfLine" maxlength="100" OptionsValidator [options]="config.TypeOfLine " />
              <span matSuffix mat-icon-button>
                <mat-icon (click)="model.TypeOfLine=''">arrow_drop_down</mat-icon>
              </span>
              <mat-autocomplete autoActiveFirstOption #autoTypeOfLine="matAutocomplete">
                <mat-option *ngFor="let option of config.TypeOfLine | ddlFilter: typeOfLine.value"
                  [value]="option">
                  {{option}}
                </mat-option>

              </mat-autocomplete>
              <mat-error *ngIf="f.TypeOfLine.errors?.validOptions">Value need to match available options</mat-error>

            </mat-form-field>
          </div>
        </ng-container>
      </div>
      <div class="matsidenav-footer">
        <button type="submit" mat-raised-button color="primary">
          <mat-icon>search</mat-icon>Search
        </button>
        <button type="reset" mat-raised-button color="primary" (click)="resetForm()">
          <mat-icon>refresh</mat-icon>Reset
        </button>
      </div>
      <!-- </div>   -->
    </form>
  </mat-sidenav>
  <mat-sidenav-content class="side-content">
    <app-start-up *ngIf="tabs.length===0"></app-start-up>
    <button *ngIf="tabs.length!=0" class="slidderbtn" mat-basic-button color="primary" (click)="pagesidenav.toggle()"
      matTooltip="{{pagesidenav.opened ? 'Hide Filters' : 'Show Filters'}}">
      <mat-icon>{{pagesidenav.opened ? 'keyboard_arrow_left' : 'keyboard_arrow_right'}}</mat-icon>
    </button>
    <mat-tab-group [(selectedIndex)]="selectedTab" style="padding-left:6px;">
      <mat-tab *ngFor="let tab of tabs; let index = index">
        <ng-template mat-tab-label>
          <div class="col" style="margin-left: 20px;">{{tab.name}}</div>
          <button *ngIf="tab.tabType !== 0" style="color:black" matSuffix mat-icon-button (click)="removeTab(index)">
            <mat-icon style="font-size: large;">close</mat-icon>
          </button>
        </ng-template>
        <span [ngSwitch]="tab.tabType">
          <div *ngSwitchCase="0" style="height: calc(100% - 30px);">
            <app-table-selection [sidePan]="pagesidenav" [tableitem]="myTable" (rowChanges)="rowDetect($event)" (pageIndex)="getNextSetRecords($event)"
              (addNewTab)="newTab($event)">
            </app-table-selection>
          </div>
          <div *ngSwitchCase="1" style="height: calc(100% - 8px);">
            <app-telephone-audit-trail [telNo]="auditTelNo" [repIdentifier]="repIdentifier"></app-telephone-audit-trail>
          </div>
          <div *ngSwitchCase="2" style="height: calc(100% - 8px);">
            <app-transaction-errors [telNo]="telNo" [tranId]="tranId" [repIdentifier]="repIdentifier">
            </app-transaction-errors>
          </div>
          <div *ngSwitchDefault>
          </div>
        </span>
      </mat-tab>
    </mat-tab-group>
  </mat-sidenav-content>
</mat-sidenav-container>